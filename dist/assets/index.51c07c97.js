import{B as g,M as r,a as l,C as y,S as L,P as w,W as v,G as f}from"./vendor.772d72ab.js";const b=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(e){if(e.ep)return;e.ep=!0;const n=s(e);fetch(e.href,n)}};b();class x{constructor(t){this.level=t,this.size=t.length,this.unitLength=.5,this.length=this.unitLength*this.size,this.meshes=[],this.startPostion={x:(this.length-this.unitLength)/2,y:0,z:this.length-this.unitLength},this.setCubes(),this.setContainer()}setCubes(){const t=new g(this.unitLength,this.unitLength,this.unitLength),s=new r;for(let i=0;i<this.level.length;i++)for(let e=0;e<this.level[i].length;e++)for(let n=0;n<this.level[i][e].length;n++)if(this.level[i][e][n]===1){const o=new l(t,s);o.position.x=this.unitLength*n,o.position.y=this.unitLength*i,o.position.z=this.unitLength*e,this.meshes.push(o)}}setContainer(){const t=new g(this.length,this.length,this.length),s=new r({transparent:!0,opacity:.4}),i=new l(t,s);i.position.x=(this.length-this.unitLength)/2,i.position.y=(this.length-this.unitLength)/2,i.position.z=(this.length-this.unitLength)/2,this.meshes.push(i)}}class z{constructor(t,s,i,e){this.geometry=new y(.1,.2),this.material=new r,this.mesh=new l(this.geometry,this.material),this.mesh.position.x=t,this.mesh.position.y=s,this.mesh.position.z=i,this.movingDistance=e}move(t){switch(t){case"forward":this.mesh.position.z-=this.movingDistance;break;case"backward":this.mesh.position.z+=this.movingDistance;break;case"right":this.mesh.position.x+=this.movingDistance;break;case"left":this.mesh.position.x-=this.movingDistance;break;case"up":this.mesh.position.y+=this.movingDistance;break;case"down":this.mesh.position.y-=this.movingDistance;break}}getPositionIndex(){const t=this.mesh.position.x/this.movingDistance,s=this.mesh.position.y/this.movingDistance,i=this.mesh.position.z/this.movingDistance;return[t,s,i]}}class m{constructor({x:t,y:s,z:i,size:e,unitLength:n}){this.position={x:t,y:s,z:i},this.size=e,this.unitLength=n,this.meshes=[],this.setCubes(),this.invisibleCubeIndex=[]}setCubes(){const t=new g(this.unitLength,this.unitLength,this.unitLength);for(let s=0;s<this.size;s++)for(let i=0;i<this.size;i++){const e=new r,n=new l(t,e);n.position.x=this.position.x+this.unitLength*i,n.position.y=this.position.y+this.unitLength*s,n.position.z=this.position.z,this.meshes.push(n)}}getCube(t,s){const i=t*this.size+s;return this.meshes[i]}}class M{constructor(t){document.addEventListener("keydown",s=>{switch(s.key){case"ArrowUp":t.input("forward");break;case"ArrowDown":t.input("backward");break;case"ArrowRight":t.input("right");break;case"ArrowLeft":t.input("left");break}})}}class k{constructor(t,s,i,e){this.level=t,this.player=s,this.xyLocationMap=i,this.xzLocationMap=e,this.updateXYLocationMap(),this.updateXZLocationMap()}move(t){this.updateXYLocationMap(),this.updateXZLocationMap(),this.player.move(t),this.updateXYLocationMap(),this.updateXZLocationMap()}input(t){for(this.playerCanMove(t)?this.move(t):this.playerCanMove("up")&&(this.move("up"),this.playerCanMove(t)&&this.move(t));this.playerCanMove("down");)this.move("down")}playerCanMove(t){let[s,i,e]=this.player.getPositionIndex();switch(t){case"forward":e-=1;break;case"backward":e+=1;break;case"right":s+=1;break;case"left":s-=1;break;case"up":i+=1;break;case"down":i-=1;break}try{return this.level[i][e][s]===0}catch{return!1}}updateXYLocationMap(){let[t,s,i]=this.player.getPositionIndex();i=this.level.length-1-i;const e=this.xyLocationMap.getCube(i,t);e.material.visible=!e.material.visible}updateXZLocationMap(){let[t,s,i]=this.player.getPositionIndex();const e=this.xzLocationMap.getCube(s,t);e.material.visible=!e.material.visible}}const C=[[[0,0,0,0,0],[0,0,0,0,0],[0,1,1,1,0],[0,0,0,1,0],[0,0,0,1,1]],[[1,1,1,1,1],[1,1,1,1,1],[1,0,0,0,1],[1,1,1,0,1],[1,1,0,0,1]],[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]],[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]],[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]]];class P{constructor(){this.level=C,this.stage=new x(this.level),this.player=new z(this.stage.startPostion.x,this.stage.startPostion.y,this.stage.startPostion.z,this.stage.unitLength),this.xyLocationMap=new m({x:0,y:this.stage.unitLength*(this.level.length+1),z:this.stage.unitLength*this.level.length,size:this.level.length,unitLength:this.stage.unitLength/2}),this.xzLocationMap=new m({x:this.stage.unitLength/2*(this.level.length+.5),y:this.stage.unitLength*(this.level.length+1),z:this.stage.unitLength*this.level.length,size:this.level.length,unitLength:this.stage.unitLength/2}),this.meshes=[...this.stage.meshes,this.player.mesh,...this.xyLocationMap.meshes,...this.xzLocationMap.meshes],this.moveHandler=new k(this.level,this.player,this.xyLocationMap,this.xzLocationMap),new M(this.moveHandler)}}const u=new L,c=new w(100,window.innerWidth/window.innerHeight,.1,1e3),p=new v;p.setSize(window.innerWidth,window.innerHeight);document.body.appendChild(p.domElement);const a=new P;u.add(...a.meshes);const D=new f(10,10);u.add(D);c.position.x=a.stage.length/2;c.position.y=a.stage.length;c.position.z=a.stage.size;function d(){requestAnimationFrame(d),a.player.mesh.rotation.y+=.01,p.render(u,c)}d();
